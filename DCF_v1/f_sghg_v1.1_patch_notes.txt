added handling for missing values